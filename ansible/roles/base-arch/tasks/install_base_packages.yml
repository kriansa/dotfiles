---
- name: create /etc/pacman.d/hooks directory
  become: true
  file: path=/etc/pacman.d/hooks state=directory mode=0755

- name: update system
  become: true
  pacman:
    update_cache: yes
    upgrade: yes

- name: install base packages
  become: true
  notify: 
    - restart dbus
    - enable kernel modules hook
  pacman:
    state: present
    name:
      - linux
      - linux-lts
      - base-devel
      - iptables-nft
      - sudo
      - avahi
      - pulseaudio
      - wget
      - openbsd-netcat
      - openssh
      - python
      - git
      - zsh
      - rsync
      - nfs-utils
      - gnupg
      - tree
      - htop
      - unzip
      - unrar
      - xz
      - p7zip
      - zip
      - hdparm
      - lsof
      - bind-tools   # dig
      - ldns         # for drill tool (dig with DNSSEC)
      - xclip        # for interaction with the clipboard
      # Pacman/update tools
      - reflector            # to update the mirrorlist with the best mirrors
      - rebuild-detector     # detect packages that needs rebuild
      - pacman-contrib       # extra tools for pacman
      - kernel-modules-hook  # no downtime on kernel updates

- meta: flush_handlers
