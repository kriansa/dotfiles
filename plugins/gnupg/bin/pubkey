#!/usr/bin/env zsh
#
# Usage: pubkey
# Description: Pipe my SSH public key to my clipboard.
#

source $DOTFILES_PATH/plugins/zsh/lib/functions/clipboard.zsh

# Use this if you're using standard SSH keys instead GnuPG agent
# more ~/.ssh/id_rsa.pub | clipcopy | echo '=> Public key copied to clipboard.'

KEY_DESCRIPTION=$(gpg -K "$GPG_MAIN_KEY" | grep uid | sed 's/.*\] //g')

gpg --export-ssh-key $GPG_MAIN_KEY | \
  sed "s/openpgp:.*/$KEY_DESCRIPTION/" | \
  clipcopy | \
  echo '=> Public key copied to clipboard.'
